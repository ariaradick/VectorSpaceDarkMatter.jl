<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VectorSpaceDarkMatter</title><meta name="title" content="Home · VectorSpaceDarkMatter"/><meta property="og:title" content="Home · VectorSpaceDarkMatter"/><meta property="twitter:title" content="Home · VectorSpaceDarkMatter"/><meta name="description" content="Documentation for VectorSpaceDarkMatter."/><meta property="og:description" content="Documentation for VectorSpaceDarkMatter."/><meta property="twitter:description" content="Documentation for VectorSpaceDarkMatter."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>VectorSpaceDarkMatter</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Direct-Detection-Rates"><span>Direct Detection Rates</span></a></li><li><a class="tocitem" href="#Projecting-g_\\chi-and-f_s2"><span>Projecting <span>$g_\chi$</span> and <span>$f_s^2$</span></span></a></li><li><a class="tocitem" href="#Calculating-the-Rate"><span>Calculating the Rate</span></a></li></ul></li><li><a class="tocitem" href="ref/reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ariaradick/VectorSpaceDarkMatter.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ariaradick/VectorSpaceDarkMatter.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="VectorSpaceDarkMatter.jl"><a class="docs-heading-anchor" href="#VectorSpaceDarkMatter.jl">VectorSpaceDarkMatter.jl</a><a id="VectorSpaceDarkMatter.jl-1"></a><a class="docs-heading-anchor-permalink" href="#VectorSpaceDarkMatter.jl" title="Permalink"></a></h1><p>Vector Spaces for Dark Matter. This is the Julia implementation  of the wavelet-harmonic integration method, designed for the efficient calculation of dark matter direct detection scattering rates in anisotropic detectors, and for arbitrary dark matter velocity distributions. See the associated papers <a href="https://arxiv.org/abs/2310.01483">[arXiv:2310.01483]</a> and <a href="https://arxiv.org/abs/2310.01480">[arXiv:2310.01480]</a> for an in-depth discussion of the methods used in this package.</p><p>See <a href="https://github.com/ariaradick/VectorSpaceDarkMatter.jl/blob/main/examples/VSDM_Example.ipynb">the example notebook</a> for a walkthrough using this package on some simple functions.</p><h2 id="Direct-Detection-Rates"><a class="docs-heading-anchor" href="#Direct-Detection-Rates">Direct Detection Rates</a><a id="Direct-Detection-Rates-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Detection-Rates" title="Permalink"></a></h2><p>For discrete final state energies <span>$\Delta E$</span> the dark matter (DM) – standard model (SM) scattering rate <span>$R$</span> is given by</p><p class="math-container">\[R = N_T \frac{\rho_\chi}{m_\chi} \int d^3 q \: d^3 v \: g_\chi(\textbf{v}) \: f_s^2(\textbf{q}) \: \delta\left( \Delta E + \frac{q^2}{2 m_\chi} - \textbf{q} \cdot \textbf{v} \right) \frac{\bar{\sigma}_0 F_{\textrm{DM}}^2(\textbf{q})}{4 \pi \mu_\chi^2}\]</p><p>Our package factorizes this calculation by projecting <span>$g_\chi(\textbf{v})$</span> and <span>$f_s^2(\textbf{q})$</span> onto vector spaces such that</p><p class="math-container">\[f(\textbf{u}) \equiv |f\rangle = \sum_{n \ell m} \langle \phi_{n \ell m} | f \rangle | \phi_{n \ell m} \rangle\]</p><p>where the basis function <span>$\phi_{n \ell m}$</span> is given by</p><p class="math-container">\[\phi_{n \ell m}(\textbf{u}) = r_n(u) Y_{\ell m}(\hat{u})\]</p><p>with <span>$r_n(u)$</span> either a spherical tophat function or a spherical Haar wavelet and <span>$Y_{\ell m}(\hat{u})$</span> the real spherical harmonics. We define the coefficients by</p><p class="math-container">\[\langle \phi_{n \ell m} | f \rangle \equiv f_{n \ell m} = \int \frac{d^3 u}{u_{\textrm{max}}^3} \: f(\textbf{u}) \: r_n(u) \: Y_{\ell m}(\hat{u})\]</p><p>where <span>$u_\textrm{max}$</span> is the maximum value of <span>$|\textbf{u}|$</span> supported by the radial basis functions. The rate can then be calculated by</p><p class="math-container">\[R = \frac{k_0}{T_\textrm{exp}} \sum_{\ell=0}^{\infty} \sum_{m,m&#39;=-\ell}^\ell \sum_{n,n&#39;=0}^{\infty} \langle v_{\textrm{max}}^3 g_\chi | n \ell m \rangle \mathcal{I}_{n,n&#39;}^\ell \langle n&#39; \ell m&#39; | f_s^2 \rangle\]</p><p>where <span>$k_0$</span> is a collection of constants, <span>$T_\textrm{exp}$</span> is the exposure time, and <span>$\mathcal{I}$</span> is referred to as the <em>kinematic scattering matrix</em>,</p><p class="math-container">\[\mathcal{I}_{n,n&#39;}^\ell = \frac{q_{\textrm{max}}^3 / v_{\textrm{max}}^3}{2 m_\chi \mu_\chi^2} \int_0^\infty \frac{q dq}{q_{\textrm{max}}^2} r^{(q)}_{n&#39;}(q) F_{\textrm{DM}}^2(q) \int_{v_\textrm{min}(q)}^\infty \frac{v dv}{v_{\textrm{max}}^2} P_\ell \left( \frac{v_{\textrm{min}}(q)}{v} \right) r^{(v)}_n(v)\]</p><p>and is analytically calculable for the tophat and Haar wavelet bases. Finally, we can also implement rotations of the detector (given generically by <span>$\mathcal{R}$</span>),</p><p class="math-container">\[R = \frac{k_0}{T_\textrm{exp}} \sum_{\ell=0}^{\infty} \sum_{m,m&#39;=-\ell}^\ell \sum_{n,n&#39;=0}^{\infty} \langle v_{\textrm{max}}^3 g_\chi | n \ell m \rangle \mathcal{I}_{n,n&#39;}^\ell G^\ell_{m,m&#39;}(\mathcal{R}) \langle n&#39; \ell m&#39; | f_s^2 \rangle\]</p><p>where <span>$G$</span> is analogous to the Wigner <span>$D$</span>-matrix, but for real spherical harmonics</p><p class="math-container">\[G_{m&#39;,m}^\ell(\mathcal{R}) \equiv \langle \ell m&#39; | \mathcal{R} | \ell m \rangle\]</p><p>We can also define a set of partial rate matrices (one for each <span>$\ell$</span>), <span>$K^{(\ell)}$</span>, which can be calculated ahead of time for each set of parameters</p><p class="math-container">\[K^{(\ell)}_{m,m&#39;} \equiv \sum_{n=0}^{\infty} \sum_{n&#39;=0}^{\infty} \langle v_{\textrm{max}}^3 g_\chi | n \ell m \rangle \mathcal{I}_{n,n&#39;}^{(\ell)} (\mathcal{R}) \langle n&#39; \ell m&#39; | f_s^2 \rangle\]</p><p>Then the rate simply becomes</p><p class="math-container">\[R(\mathcal{R}) = \frac{k_0}{T_{\textrm{exp}}} \sum_\ell \sum_{m,m&#39;} K^{\ell}_{m,m&#39;} G^\ell_{m,m&#39;}(\mathcal{R})\]</p><h2 id="Projecting-g_\\chi-and-f_s2"><a class="docs-heading-anchor" href="#Projecting-g_\\chi-and-f_s2">Projecting <span>$g_\chi$</span> and <span>$f_s^2$</span></a><a id="Projecting-g_\\chi-and-f_s2-1"></a><a class="docs-heading-anchor-permalink" href="#Projecting-g_\\chi-and-f_s2" title="Permalink"></a></h2><p>The first step in using this package to do a calculation is to project your velocity distribution <span>$g_\chi(\textbf{v})$</span> and momentum form factor <span>$f_s^2(\textbf{q})$</span> onto the vector space. First, decide your maximum <span>$v$</span> and <span>$q$</span> values. Make sure your <span>$v$</span> and <span>$q$</span> are in natural units. Then we can use the function <code>ProjectF</code></p><pre><code class="nohighlight hljs">gx_nlm = ProjectF(gx, (n_max, ell_max), Wavelet(vmax))
fs2_nlm = ProjectF(fs2, (n_max, ell_max), Wavelet(qmax))</code></pre><p>This will store your coefficients in a <code>ProjectedF</code> object, which has fields <code>fnlm</code> which stores the coefficient values, <code>lm</code> which stores the <span>$(\ell,m)$</span> pairs for each column of <code>fnlm</code>, and <code>radial_basis</code> which stores the radial basis and with it, the maximum <span>$v$</span> or <span>$q$</span> value. You can save the coefficients with <code>writeFnlm</code></p><pre><code class="nohighlight hljs">writeFnlm(&quot;filename.csv&quot;, projected_f)</code></pre><p>If you already have stored coefficients, you can load them with</p><pre><code class="nohighlight hljs">readFnlm(&quot;filename.csv&quot;)</code></pre><p>or</p><pre><code class="nohighlight hljs">readFnlm(&quot;filename.csv&quot;, Wavelet(umax))</code></pre><p>if you want to define the radial basis by hand. This is helpful because it can often take a while to calculate these coefficients, particularly for large <code>n_max</code> and <code>ell_max</code>.</p><h2 id="Calculating-the-Rate"><a class="docs-heading-anchor" href="#Calculating-the-Rate">Calculating the Rate</a><a id="Calculating-the-Rate-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-the-Rate" title="Permalink"></a></h2><p>To deal with rotations, we&#39;ll want to import the <code>Quaternionic.jl</code> package</p><pre><code class="nohighlight hljs">using Quaternionic</code></pre><p>you can see <a href="https://moble.github.io/Quaternionic.jl/stable/">their documentation</a> to see how to convert from other rotation types to quaternions. We can define a quaternion by</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; q = quaternion(1.0, 2.0, 3.0, 4.0)</code><code class="nohighlight hljs ansi" style="display:block;">1.0 + 2.0𝐢 + 3.0𝐣 + 4.0𝐤</code></pre><p>We also need to define the model, including the dark matter mass <span>$m_\chi$</span>, the dark matter form factor <span>$F_{\textrm{DM}}$</span>, and the transition energy <span>$\Delta E$</span>. To compactly store these values, we use a <code>ModelDMSM</code> object</p><pre><code class="nohighlight hljs">dmsm_model = ModelDMSM(fdm_n, mX, mSM, deltaE)</code></pre><p>Finally, there is an overall prefactor for the rate, called <span>$k_0$</span>, and we can store the relevant parameters for that in an <code>ExposureFactor</code> object,</p><pre><code class="nohighlight hljs">exp_factor = ExposureFactor(N_T, sigma0, rhoX)</code></pre><p>Once you have a quaternion or rotor defining your desired rotation and have defined your model and prefactor you can easily calculate the rate by</p><pre><code class="nohighlight hljs">R = rate(q, exp_factor, dmsm_model, gx_nlm, fs2_nlm)</code></pre><p>It&#39;s very quick to implement more rotations, so you can also pass a vector of quaternions (or rotors) to <code>rate</code></p><pre><code class="nohighlight hljs">R = rate(Q, exp_factor, dmsm_model, gx_nlm, fs2_nlm)</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="ref/reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Sunday 4 May 2025 18:24">Sunday 4 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
